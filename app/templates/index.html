{% extends "base.html" %}
{% block title %}Home{% endblock %}
{% block body %}

<script type="text/javascript">
  $(document).ready(function() {

    alert($('#authorization_code').val());

    $('#btn-credentials').on('click', function() {
      console.log("Clicking the button now!");
      $.ajax({
        type: 'GET',
        url: '/user_info',
        data: {
          authz_code: $('#authorization_code').val()
        },
        success: function(data) {
          console.log(data);
          $('#user_id').val(data.user.user_id);
          $('#access_token').val(data.user.access_token);
        },
        error: function(data) {
          console.log(data);
        }
      });
    });

    // for the user labels AJAX call
    $('#btn-labels').on('click', function() {
      console.log("Clicking the labels button now!");
      $.ajax({
        type: 'GET',
        url: '/user_labels',
        data: {
          user_id: $('#user_id').val(),
          access_token: $('#access_token').val()
        },
        success: function(data) {
          console.log(data);
        },
        error: function(data) {
          console.log(data);
        }
      });
    });

  });


</script>

<div class="jumbotron">
  <h1>Flask Is Awesome</h1>
  <p class="lead">And I'm glad to be learning so much about it!</p>

  <input type="hidden" id="authorization_code" value="{{authz_code}}" />
  <input type="hidden" id="user_id" value="{{user_id}}" />
  <input type="hidden" id="access_token" value="{{access_token}}" />
  <button id="btn-credentials" class="btn btn-lg btn-primary">
    Get Credentials
  </button>
  <button id="btn-labels" class="btn btn-lg btn-primary">
    Get User Labels
  </button>

  <p>
    {{ response }}
  </p>

</div>
{% endblock %}
